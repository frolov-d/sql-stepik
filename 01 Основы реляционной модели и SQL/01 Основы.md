###### 1. Создать таблицу:
```sql
CREATE TABLE book (
    book_id INT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(50),
    author VARCHAR(30),
    price DECIMAL(8, 2),
    amount INT
);
```
###### 2. Вставить данные:
```sql
INSERT INTO book (title, author, price, amount)
VALUES ('Мастер и Маргарита', 'Булгаков М.А.', 670.99, 3);
INSERT INTO supply (title, author, price, amount)
VALUES ('Лирика', 'Пастернак Б.Л.', 518.99, 2),
    ('Черный человек', 'Есенин С.А.', 570.20, 6),
    ('Белая гвардия', 'Булгаков М.А.', 540.50, 7),
    ('Идиот', 'Достоевский Ф.М.', 360.80, 3);
```
###### 3.  Псевдонимы (aliases):
```sql
SELECT title AS Название, author AS Автор
FROM book;
```
###### 4. Выборка с созданием вычисляемого столбца:
Для упаковки каждой книги требуется 1 лист бумаги, цена которого 1 рубль 65 копеек.  Посчитать стоимость упаковки для каждой книги (сколько денег потребуется, чтобы упаковать все экземпляры книги). В запросе вывести название книги, ее количество и стоимость упаковки, последний столбец назвать pack.
```sql
SELECT title, amount, amount * 1.65 AS pack
FROM book;
```
###### 5. Выборка данных, вычисляемые столбцы, математические функции:
В конце года цену всех книг на складе пересчитывают – снижают ее на 30%. Написать SQL запрос, который из таблицы book выбирает названия, авторов, количества и вычисляет новые цены книг. Столбец с новой ценой назвать new_price, цену округлить до 2-х знаков после запятой.
```sql
SELECT title, author, amount, ROUND((price - (price * 0.3)), 2) AS new_price
FROM book;
```
###### 6.  Выборка данных, вычисляемые столбцы, логические функции:
При анализе продаж книг выяснилось, что наибольшей популярностью пользуются книги Михаила Булгакова, на втором месте книги Сергея Есенина. Исходя из этого решили поднять цену книг Булгакова на 10%, а цену книг Есенина - на 5%. Написать запрос, куда включить автора, название книги и новую цену, последний столбец назвать new_price. Значение округлить до двух знаков после запятой.
```sql
SELECT author, title, 
	ROUND(
    (
      IF (
        author = 'Булгаков М.А.', price * 1.1, 
        IF (
          author = 'Есенин С.А.', price * 1.05, price
        )
      )
    ), 
    2
  ) AS new_price 
FROM 
  book;
```
###### 7. Выборка по условию:
```sql
SELECT author, title, price
FROM book
WHERE amount < 10;
```
###### 8. Выборка данных, логические операции:
Вывести название, автора,  цену  и количество всех книг, цена которых меньше 500 или больше 600, а стоимость всех экземпляров этих книг больше или равна 5000.
```sql
SELECT title, author, price, amount
FROM book
WHERE (price < 500 OR price > 600) AND amount * price >= 5000;
```
###### 9. Выборка данных, операторы BETWEEN, IN:
Вывести название и авторов тех книг, цены которых принадлежат интервалу от 540.50 до 800 (включая границы),  а количество или 2, или 3, или 5, или 7.
```sql
SELECT title, author
FROM book
WHERE price BETWEEN 540.50 AND 800
AND amount IN (2, 3, 5, 7);
```
###### 10. Выборка данных, оператор LIKE:
Вывести название и автора тех книг, название которых состоит из двух и более слов, а инициалы автора содержат букву «С». Считать, что в названии слова отделяются друг от друга пробелами и не содержат знаков препинания, между фамилией автора и инициалами обязателен пробел, инициалы записываются без пробела в формате: буква, точка, буква, точка.
```sql
SELECT title, author
FROM book
WHERE title LIKE '_% %' AND author LIKE '%С.%';
```
###### 11. Выборка данных с сортировкой:
Вывести  автора и название  книг, количество которых принадлежит интервалу от 2 до 14 (включая границы). Информацию  отсортировать по авторам (в обратном алфавитном порядке) и названиям (по алфавиту).
```sql
SELECT author, title
FROM book
WHERE amount BETWEEN 2 AND 14
ORDER BY author DESC, title;
```
###### 12. Выборка данных, групповые функции SUM и COUNT:
Посчитать, количество различных книг и количество экземпляров книг каждого автора , хранящихся на складе. Вычисляемые столбцы назвать Различных\_книг и Количество\_экземпляров соответственно, столбец с фамилиями авторов назвать Автор.
```sql
SELECT author AS Автор, COUNT(author) AS Различных_книг, SUM(amount) AS Количество_экземпляров
FROM book
GROUP BY author;
```
###### 13. Выборка данных, групповые функции MIN, MAX и AVG:
Вывести минимальную, максимальную и среднюю цену книг каждого автора. Вычисляемые столбцы назвать Минимальная\_цена, Максимальная\_цена и Средняя\_цена соответственно.
```sql
SELECT author,
      MIN(price) 'Минимальная_цена',
      MAX(price) 'Максимальная_цена',
      AVG(price) 'Средняя_цена'
FROM book
GROUP BY author;
```
###### 14. Выборка данных c вычислением, групповые функции:
Для каждого автора вычислить суммарную стоимость книг S (имя столбца Стоимость), а также вычислить налог на добавленную стоимость  для полученных сумм (имя столбца НДС) , который включен в стоимость и составляет k = 18%,  а также стоимость книг  (Стоимость\_без\_НДС) без него. Значения округлить до двух знаков после запятой.
```sql
SELECT 
    author, 
    SUM(price*amount) AS 'Стоимость', 
    ROUND(SUM(price*amount)*0.18 / 1.18, 2) AS 'НДС',
    ROUND(SUM(price*amount) / 1.18, 2) AS 'Стоимость_без_НДС'
FROM book GROUP BY author;
```
###### 15. Вычисления по таблице целиком:
Вывести  цену самой дешевой книги, цену самой дорогой и среднюю цену книг на складе. Названия столбцов Минимальная\_цена, Максимальная\_цена, Средняя\_цена соответственно. Среднюю цену округлить до двух знаков после запятой.
```sql
SELECT MIN(price) AS Минимальная_цена,
    MAX(price) AS Максимальная_цена,
    ROUND(AVG(price), 2) AS Средняя_цена 
FROM book;
```
###### 16. Выборка данных по условию, групповые функции:
Вычислить среднюю цену и суммарную стоимость тех книг, количество экземпляров которых принадлежит интервалу от 5 до 14, включительно. Столбцы переименовать как показано в образце, значения округлить до 2-х знаков после запятой.
```sql
SELECT
    ROUND(AVG(price), 2) AS Средняя_цена,
    SUM(price * amount) AS Стоимость
FROM book
WHERE amount BETWEEN 5 AND 14;
```
###### 17. Выборка данных по условию, групповые функции, WHERE и HAVING:
Посчитать стоимость всех экземпляров каждого автора без учета книг «Идиот» и «Белая гвардия». В результат включить только тех авторов, у которых суммарная стоимость книг более 5000 руб. Результат отсортировать по убыванию стоимости.
```sql
SELECT author, SUM(amount * price) AS Стоимость
FROM book
WHERE title <> 'Идиот' AND title <> 'Белая гвардия'
GROUP BY author
HAVING SUM(amount * price) > 5000
ORDER BY Стоимость DESC;
```
###### 18. Вложенный запрос, возвращающий одно значение:
Вывести информацию (автора, название и цену) о  книгах, цены которых меньше или равны средней цене книг на складе. Информацию вывести в отсортированном по убыванию цены виде. Среднее вычислить как среднее по цене книги.
```sql
SELECT author, title, price
FROM book
WHERE price <= (
    SELECT AVG(price)
    FROM book
    )
ORDER BY price DESC;
```
###### 19. Использование вложенного запроса в выражении:
Вывести информацию (автора, название и цену) о тех книгах, цены которых превышают минимальную цену книги на складе не более чем на 150 рублей в отсортированном по возрастанию цены виде.
```sql
SELECT author, title, price
FROM book
WHERE price <= 150 + (SELECT MIN(price)
						FROM book)
ORDER BY price;
```
###### 20. Вложенный запрос, оператор IN:
Вывести информацию (автора, книгу и количество) о тех книгах, количество экземпляров которых в таблице book не повторяется.
```sql
SELECT author,
       title,
       amount
FROM book
WHERE amount =
    (SELECT amount
     FROM book
     GROUP BY amount
     HAVING COUNT(amount) = 1);
```
###### 21. Вложенный запрос, операторы ANY и ALL:
Вывести информацию о книгах (автор, название, цена), цена которых меньше самой большой из минимальных цен, вычисленной для каждого автора.
```sql
SELECT author,
       title,
       price
FROM book
WHERE price < ANY
    (SELECT MIN(price)
     FROM book
     GROUP BY author);
```
Вывести информацию о тех книгах, количество которых меньше самого маленького среднего количества книг каждого автора.
```sql
SELECT title, author, amount, price
FROM book
WHERE amount < ALL (
        SELECT AVG(amount) 
        FROM book 
        GROUP BY author 
      );
```
###### 22. Вложенный запрос после SELECT:
Посчитать сколько и каких экземпляров книг нужно заказать поставщикам, чтобы на складе было одинаковое количество экземпляров каждой книги, равное значению самого большего количества экземпляров одной книги на складе. Столбцу с количеством заказываемых экземпляров книг присвоить имя Заказ.
```sql
SELECT title,
       author,
       amount,
       ((SELECT MAX(amount)
           FROM book) - amount) AS Заказ
FROM book
WHERE amount <
    (SELECT MAX(amount)
     FROM book);
```
###### 23. Добавление записей из другой таблицы:
Добавить из таблицы supply в таблицу book, все книги, кроме книг, написанных Булгаковым М.А. и Достоевским Ф.М.
```sql
INSERT INTO book (title, author, price, amount)
SELECT title, author, price, amount
FROM supply
WHERE author <> 'Булгаков М.А.' AND author <> 'Достоевский Ф.М.';
```
###### 24. Добавление записей, вложенные запросы:
Занести из таблицы supply в таблицу book только те книги, авторов которых нет в  book.
```sql
INSERT INTO book (title, author, price, amount) 
           SELECT title, author, price, amount 
           FROM supply
           WHERE author NOT IN (SELECT DISTINCT author FROM book);
```
###### 25. Запросы на обновление:
Уменьшить на 10% цену тех книг в таблице book, количество которых принадлежит интервалу от 5 до 10 включительно.
```sql
UPDATE book
SET    price = price * 0.9
WHERE  amount BETWEEN 5 AND 10;
```
###### 26. Запросы на обновление нескольких столбцов:
В таблице book необходимо скорректировать значение для покупателя в столбце buy таким образом, чтобы оно не превышало допустимый остаток в столбце amount. А цену тех книг, которые покупатель не заказывал, снизить на 10%.
```sql
UPDATE book
SET buy = IF(buy > amount, amount, buy), 
    price = IF(buy = 0, price * 0.9, price);
```
###### 27. Запросы на обновление нескольких таблиц:
Для тех книг в таблице book , которые есть в таблице supply, не только увеличить их количество в таблице book (увеличить их количество на значение столбца amountтаблицы supply), но и пересчитать их цену (для каждой книги найти сумму цен из таблиц book и supply и разделить на 2).
```sql
UPDATE book, supply
SET book.amount = book.amount + supply.amount, 
    book.price = (book.price + supply.price) / 2
WHERE book.title = supply.title AND book.author = supply.author;
```
###### 28. Запросы на удаление:
Удалить из таблицы supply книги тех авторов, общее количество экземпляров книг которых в таблице book превышает 10.
```sql
DELETE FROM supply
WHERE author IN
    (SELECT author
     FROM book
     GROUP BY author
     HAVING SUM(amount) > 10);
```
###### 29. Запросы на создание таблицы:
Создать таблицу заказ (ordering), куда включить авторов и названия тех книг, количество экземпляров которых в таблице book меньше среднего количества экземпляров книг в таблице book. В таблицу включить столбец   amount, в котором для всех книг указать одинаковое значение - среднее количество экземпляров книг в таблице book.
```sql
CREATE TABLE ordering AS
SELECT author,
       title,
  (SELECT ROUND(AVG(amount))
   FROM book) AS amount
FROM book
WHERE amount <
    (SELECT ROUND(AVG(amount))
     FROM book);
```